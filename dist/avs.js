/*! codemirror-avs | MIT License | github.com/visbot/codemirror-avs */
!function(e){"object"==typeof exports&&"object"==typeof module?e(require("codemirror")):"function"==typeof define&&define.amd?define(["codemirror"],e):e(CodeMirror)}(function(E){"use strict";function O(e,t,n,i,a,r){this.indented=e,this.column=t,this.type=n,this.info=i,this.align=a,this.prev=r}function T(e,t,n,i){var a=e.indented;return e.context&&"statement"==e.context.type&&"statement"!=n&&(a=e.context.indented),e.context=new O(a,t,n,i,null,e.context)}function q(e){var t=e.context.type;return")"!=t&&"]"!=t&&"}"!=t||(e.indented=e.context.indented),e.context=e.context.prev}function A(e,t,n){return"variable"==t.prevToken||"type"==t.prevToken||(!!/\S(?:[^- ]>|[*\]])\s*$|\*$/.test(e.string.slice(0,n))||(!(!t.typeAtEndOfLine||e.column()!=e.indentation())||void 0))}function P(e){for(;;){if(!e||"top"==e.type)return 1;if("}"==e.type&&"namespace"!=e.prev.info)return;e=e.prev}}function e(e){for(var t={},n=e.split(" "),i=0;i<n.length;++i)t[n[i]]=!0;return t}function B(e,t){return"function"==typeof e?e(t):e.propertyIsEnumerable(t)}function t(e,t){"string"==typeof e&&(e=[e]);var n=[];function i(e){if(e)for(var t in e)e.hasOwnProperty(t)&&n.push(t)}i(t.variables),i(t.builtin),i(t.constants),n.length&&(t.helperType=e[0],E.registerHelper("hintWords",e[0],n));for(var a=0;a<e.length;++a)E.defineMIME(e[a],t)}E.defineMode("avs",function(e,r){var s,o,l=e.indentUnit,c=r.statementIndentUnit||l,u=r.dontAlignCalls,a=r.keywords||{},d=r.builtin||{},f=r.blockKeywords||{},v=r.defKeywords||{},m=r.types||{},p=r.constants||{},b=r.variables||{},y=r.hooks||{},h=r.multiLineStrings,x=!1!==r.indentStatements,w=(r.indentSwitch,r.namespaceSeparator),g=r.isPunctuationChar||/[\[\]{}\(\),;\:\.]/,k=r.numberStart||/[\d\.]/,S=r.number||/^(?:0x[a-f\d]+|0b[01]+|(?:\d+\.?\d*|\.\d+)(?:e[-+]?\d+)?)(u|ll?|l|f)?/i,z=r.isOperatorChar||/[+\-*&%=<>!?|\/]/,C=r.isIdentifierChar||/[\w\$_\xa1-\uffff]/;function $(e,t){var r,n=e.next();if(y[n]){var i=y[n](e,t);if(!1!==i)return i}if('"'==n||"'"==n)return t.tokenize=(r=n,function(e,t){for(var n,i=!1,a=!1;null!=(n=e.next());){if(n==r&&!i){a=!0;break}i=!i&&"\\"==n}return!a&&(i||h)||(t.tokenize=null),"string"}),t.tokenize(e,t);if(g.test(n))return s=n,null;if(k.test(n)){if(e.backUp(1),e.match(S))return"number";e.next()}if("/"==n){if(e.eat("*"))return(t.tokenize=I)(e,t);if(e.eat("/"))return e.skipToEnd(),"comment"}if(z.test(n)){for(;!e.match(/^\/[\/*]/,!1)&&e.eat(z););return"operator"}if(e.eatWhile(C),w)for(;e.match(w);)e.eatWhile(C);n=e.current();return B(a,n)?(B(f,n)&&(s="newstatement"),B(v,n)&&(o=!0),"keyword"):B(m,n)?"type":B(d,n)?(B(f,n)&&(s="newstatement"),"builtin"):B(b,n)?"variable":B(p,n)?"variable-2":"keyword"}function I(e,t){for(var n,i=!1;n=e.next();){if("/"==n&&i){t.tokenize=null;break}i="*"==n}return"comment"}function L(e,t){r.typeFirstDefinitions&&e.eol()&&P(t.context)&&(t.typeAtEndOfLine=A(e,t,e.pos))}return{startState:function(e){return{tokenize:null,context:new O((e||0)-l,0,"top",null,!1),indented:0,startOfLine:!0,prevToken:null}},token:function(e,t){var n=t.context;if(e.sol()&&(null==n.align&&(n.align=!1),t.indented=e.indentation(),t.startOfLine=!0),e.eatSpace())return L(e,t),null;s=o=null;var i,a=(t.tokenize||$)(e,t);if("comment"==a||"meta"==a)return a;if(null==n.align&&(n.align=!0),";"==s||":"==s||","==s&&e.match(/^\s*(?:\/\/.*)?$/,!1))for(;"statement"==t.context.type;)q(t);else if("{"==s)T(t,e.column(),"}");else if("["==s)T(t,e.column(),"]");else if("("==s)T(t,e.column(),")");else if("}"==s){for(;"statement"==n.type;)n=q(t);for("}"==n.type&&(n=q(t));"statement"==n.type;)n=q(t)}else s==n.type?q(t):x&&(("}"==n.type||"top"==n.type)&&";"!=s||"statement"==n.type&&"newstatement"==s)&&T(t,e.column(),"statement",e.current());return"variable"==a&&("def"==t.prevToken||r.typeFirstDefinitions&&A(e,t,e.start)&&P(t.context)&&e.match(/^\s*\(/,!1))&&(a="def"),!y.token||void 0!==(i=y.token(e,t,a))&&(a=i),"def"==a&&!1===r.styleDefs&&(a="variable"),t.startOfLine=!1,t.prevToken=o?"def":a||s,L(e,t),a},indent:function(e,t){if(e.tokenize!=$&&null!=e.tokenize||e.typeAtEndOfLine)return E.Pass;var n=e.context,i=t&&t.charAt(0);if("statement"==n.type&&"}"==i&&(n=n.prev),r.dontIndentStatements)for(;"statement"==n.type&&r.dontIndentStatements.test(n.info);)n=n.prev;if(y.indent){var a=y.indent(e,n,t);if("number"==typeof a)return a}e=i==n.type,a=n.prev&&"switch"==n.prev.info;if(r.allmanIndentation&&/[{(]/.test(i)){for(;"top"!=n.type&&"}"!=n.type;)n=n.prev;return n.indented}return"statement"==n.type?n.indented+("{"==i?0:c):!n.align||u&&")"==n.type?")"!=n.type||e?n.indented+(e?0:l)+(e||!a||/^(?:case|default)\b/.test(t)?0:l):n.indented+c:n.column+(e?0:1)},blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:"//"}});var n=e("abs sin cos tan asin acos atan atan2 sqr sqrt invsqrt pow exp log log10 floor ceil sign min max sigmoid rand band bor bnot if assign exec2 equal above below getosc getspec gettime getkbmouse megabuf gmegabuf loop"),i=e("$e $phi $pi $E $PHI $PI"),a=!1;t(["avs/bump"],{name:"avs",variables:e("x y isBeat isLBeat bi"),builtin:n,constants:i,indentSwitch:a}),t(["avs/color-modifier","avs/cm"],{name:"avs",variables:e("red green blue"),builtin:n,constants:i,indentSwitch:a}),t(["avs/dynamic-distance-modifier","avs/ddm"],{name:"avs",variables:e("d"),builtin:n,constants:i,indentSwitch:a}),t(["avs/dynamic-movement","avs/dm"],{name:"avs",variables:e("x y w h r d alpha"),builtin:n,constants:i,indentSwitch:a}),t(["avs/dynamic-shift","avs/ds"],{name:"avs",variables:e("x y w h b alpha"),builtin:n,constants:i,indentSwitch:a}),t(["avs/effect-list","avs/el"],{name:"avs",variables:e("enabled beat clear alphain alphaout w h"),builtin:n,constants:i,indentSwitch:a}),t(["avs/movement","avs/mov"],{name:"avs",variables:e("r d x y sw sh"),builtin:n,constants:i,indentSwitch:a}),t(["avs/superscope","avs/ssc"],{name:"avs",variables:e("n x y i v b red green blue linesize skip drawmode w h"),builtin:n,constants:i,indentSwitch:a}),t(["avs/texer2","avs/t2"],{name:"avs",variables:e("n w h i x y v b iw ih sizex sizey red green blue skip"),builtin:n,constants:i,indentSwitch:a}),t(["avs/triangle","avs/tr"],{name:"avs",variables:e("n x1 x2 x3 y1 y2 y3 z1 skip red1 blue1 green1 w h zbclear zbuf"),builtin:n,constants:i,indentSwitch:a}),t(["text/x-avs","avs","avs/*"],{name:"avs",variables:e("alpha alphain alphaout b beat bi blue blue1 clear d drawmode enabled green green1 h i ih isBeat isLBeat iw linesize n r red red1 sh sizex sizey skip sw v w x x1 x2 x3 y y1 y2 y3 z1 zbclear zbuf"),builtin:n,constants:i,indentSwitch:a})});